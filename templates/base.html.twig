<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    {# meta.title #}
    <title>
      {%- block meta_title -%}
        {%- if meta.title is defined and meta.title is not empty -%}
            {{ meta.title }} - Kakeibo
        {%- else -%}
            Kakeibo
        {%- endif -%}
      {%- endblock -%}
    </title>

    {# meta.desc #}
    {%- block meta_desc -%}
      {% if meta.desc is defined and meta.desc is not empty %}
        <meta name="description" content="{{ meta.desc }}" />
      {% endif %}
    {%- endblock -%}

    {# meta.favicons #}
    {% include 'components/head-favicons.html.twig' %}

    {# meta.robots #}
    {% if meta.robots is defined and meta.robots is not empty %}
      <meta name="robots" content="{{ meta.robots }}" />
    {% else %}
      <meta name="robots" content="noindex, nofollow" />
    {% endif %}

    {# Stylesheets #}
    <link rel="stylesheet" href="{{ asset('build/google-fonts.css') }}">
    {{ encore_entry_link_tags('kakeibo') }}
    {% if stylesheets is defined %}
      {% for entry_name in stylesheets %}
        {{ encore_entry_link_tags(entry_name) }}
      {% endfor %}
    {% endif %}
    {# Custom stylesheets from twig templates #}
    {% block stylesheets %}{% endblock %}
  </head>

  <body class="app-core{% if core_class is defined %} {{ core_class }}{% endif %}">
    {# Add loading class on body here, in order to avoid blinking when it's done in kakeibo.js #}
    <script type="text/javascript">document.getElementsByClassName('app-core')[0].classList.add('app-core--is-loading');</script>

    {# Header #}
    {% block header %}
      <div class="app-header">
        {% include 'components/header.html.twig' %}
      </div>
    {% endblock %}

    <div id="app" class="app-body{% if body_class is defined %} {{ body_class }}{% endif %}">
      {# Notices/Errors messages from "flashbag" #}
      {% block flashes %}
        <div class="app-flashes container">{% include 'components/flashes.html.twig' %}</div>
      {% endblock %}

      {# Body #}
      {% block body %}{% endblock %}
    </div>

    {# Footer #}
    {% block footer %}
      {% include 'components/footer.html.twig' %}
    {% endblock %}

    <span class="viewport-sizes">
      <span class="d-block d-sm-none" data-viewport-size-slug="xs"></span>
      <span class="d-none d-sm-block d-md-none" data-viewport-size-slug="sm"></span>
      <span class="d-none d-md-block d-lg-none" data-viewport-size-slug="md"></span>
      <span class="d-none d-lg-block d-xl-none" data-viewport-size-slug="lg"></span>
      <span class="d-none d-xl-block" data-viewport-size-slug="xl"></span>
    </span>

    {# Display some templates ONLY IF user is connected #}
    {% if app.user is defined and app.user is not null %}
      {# Modals #}
      {% include 'components/modals/confirm-delete.html.twig' %}

      {# Display panel to add/edit transaction ONLY IF user is connected AND
        transaction form is defined (and not forced to hide) #}
      {% if form_transaction is defined and hide_form_trans_panel is not defined %}
        <div class="app-panel app-panel--top app-panel--transaction-form">
          <div class="-inner container">
            {{ form_start(form_transaction, { 'action': path('transaction_manage'), 'attr' : { 'class': '-use-ajax-submit' } }) }}
              {% include 'components/forms/transaction.html.twig' %}

              <div class="mt-2 text-center">
                <button class="btn btn-sm btn-outline-light mx-1 toggle-panel-transaction"
                  type="button" data-panel-type="close">
                  Annuler
                </button>

                <button class="btn btn-primary mx-1" type="submit" name="submit">
                  <span class="d-edit-none">
                    <span class="icon icon-plus-square"></span>
                    Ajouter
                  </span>
                  <span class="d-edit-inline-block">
                    <span class="icon icon-edit"></span>
                    Modifier
                  </span>
                </button>
              </div>
            {{ form_end(form_transaction) }}
          </div>
        </div>
      {% endif %}
    {% endif %}

    <div class="app-loader"></div>

    {# Custom javascripts from twig templates #}
    {% block javascripts_defines %}{% endblock %}

    {# Javascripts #}
    {{ encore_entry_script_tags('kakeibo') }}
    {% if scripts is defined %}
      {% for entry_name in scripts %}
        {{ encore_entry_script_tags(entry_name) }}
      {% endfor %}
    {% endif %}

    {# Custom javascripts from twig templates #}
    {% block javascripts %}{% endblock %}
  </body>
</html>
